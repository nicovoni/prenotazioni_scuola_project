{% extends "base.html" %}

{% block title %}Operazioni Amministrative{% endblock %}

{% block content %}
<div class="page-header" role="region" aria-labelledby="page-title">
    <h1 id="page-title" class="page-title">âš™ï¸ Operazioni Amministrative</h1>
    <p class="page-subtitle">Funzioni avanzate per amministratori del sistema</p>
</div>

<div class="card-simple">
    <div class="row">
        <div class="col-lg-8 mx-auto">
            <div class="alert alert-danger" role="alert">
                <h4 class="alert-heading">âš ï¸ Zona di pericolo</h4>
                <p>Le operazioni elencate di seguito eseguono modifiche irreversibili al sistema. Utilizzale solo se sei sicuro di quello che fai.</p>
            </div>

            <div class="card shadow-sm mb-4">
                <div class="card-header bg-primary text-white">
                    <h5 class="card-title mb-0">âš™ï¸ Configurazione Sistema</h5>
                </div>
                <div class="card-body">
                    <p class="card-text">Accesso al wizard di configurazione iniziale del sistema.</p>
                    <p class="card-text">
                        <strong>Permette di:</strong>
                    </p>
                    <ul class="list-unstyled ms-3">
                        <li>âœï¸ Modificare le informazioni della scuola</li>
                        <li>ğŸ”§ Gestire risorse (laboratori e carrelli)</li>
                        <li>ğŸ‘¤ Ricreare/amministrare l'account amministratore</li>
                    </ul>

                    <a href="{% url 'prenotazioni:setup_amministratore' %}" class="btn btn-primary btn-lg" role="button" aria-label="Apri Wizard Configurazione">
                        ğŸš€ Apri Wizard Configurazione
                    </a>
                </div>
            </div>

            <div class="card shadow-sm mb-4">
                <div class="card-header bg-success text-white">
                    <h5 class="card-title mb-0">ğŸ“Š Database Viewer</h5>
                </div>
                <div class="card-body">
                    <p class="card-text">Visualizza il contenuto completo di tutte le tabelle del database.</p>
                    <p class="card-text">
                        <strong>Permette di:</strong>
                    </p>
                    <ul class="list-unstyled ms-3">
                        <li>ğŸ‘€ Vedere tutti gli utenti registrati</li>
                        <li>ğŸ“… Esaminare tutte le prenotazioni esistenti</li>
                        <li>ğŸ› ï¸ Ispezionare risorse e configurazione scuola</li>
                        <li>ğŸ” Controllare lo stato completo del sistema</li>
                    </ul>

                    <a href="{% url 'prenotazioni:database_viewer' %}" class="btn btn-success btn-lg" role="button" aria-label="Visualizza Database Completo">
                        ğŸ‘ï¸ Visualizza Database Completo
                    </a>
                </div>
            </div>

            <div class="card shadow-sm mb-4">
                <div class="card-header bg-danger text-white">
                    <h5 class="card-title mb-0">ğŸ”„ Reset Completo del Sistema</h5>
                </div>
                <div class="card-body">
                    <p class="card-text"><strong>ATTENZIONE: Questa operazione Ã¨ totale e irreversibile!</strong></p>
                    <p class="card-text">Questa operazione eliminerÃ  definitivamente:</p>
                    <ul class="list-unstyled ms-3">
                        <li>âœ… <strong>TUTTI gli utenti</strong> (incluso l'amministratore corrente)</li>
                        <li>âœ… Tutte le prenotazioni esistenti</li>
                        <li>âœ… Tutte le risorse (laboratori e carrelli)</li>
                        <li>âœ… Tutte le informazioni sulla scuola</li>
                    </ul>
                    <p class="card-text">
                        <strong>Dopo il reset verrai scollegato e dovrai riconfigurare tutto da zero.</strong>
                    </p>

                    <form method="post" onsubmit="return confirm('ATTENZIONE: Questa operazione Ã¨ IRREVERSIBILE!\n\nSei sicuro di voler procedere con il reset completo del sistema?\n\nTutti i dati verranno persi definitivamente.');">
                        {% csrf_token %}
                        <input type="hidden" name="action" value="reset">
                        <button type="submit" class="btn btn-danger btn-lg" aria-label="Esegui reset completo">
                            ğŸš¨ Esegui Reset Completo
                        </button>
                    </form>
                </div>
            </div>

            <div class="card shadow-sm">
                <div class="card-header bg-info text-white">
                    <h5 class="card-title mb-0">â„¹ï¸ Altre Operazioni Future</h5>
                </div>
                <div class="card-body">
                    <p class="card-text">Qui verranno aggiunte altre funzionalitÃ  amministrative avanzate.</p>
                </div>
            </div>

                <div class="text-center mt-4">
                <a href="{% url 'prenotazioni:lista_prenotazioni' %}" class="btn btn-secondary" role="button" aria-label="Torna alle Prenotazioni">
                    â† Torna alle Prenotazioni
                </a>
            </div>
        </div>
    </div>
</div>

<style>
.card {
    border: none;
    border-radius: 10px;
}
            {% for card in admin_cards|slice:':3' %}
            <div class="card shadow-sm mb-4">
                <div class="card-header {{ card.header_class }}">
                    <h5 class="card-title mb-0">{{ card.title }}</h5>
                </div>
                <div class="card-body">
                    <p class="card-text">{{ card.text }}</p>
                    {% if card.list %}
                    <ul class="list-unstyled ms-3">
                        {% for item in card.list %}
                        <li>{{ item }}</li>
                        {% endfor %}
                    </ul>
                    {% endif %}
                    {% if card.button_url %}
                    <a href="{{ card.button_url }}" class="btn {{ card.button_class }}">
                        {{ card.button_text }}
                    </a>
                    {% endif %}
                    {% if card.form %}
                    <form method="post" onsubmit="return confirm('{{ card.form.confirm_message }}');">
                        {% csrf_token %}
                        <input type="hidden" name="action" value="reset">
                        <button type="submit" class="btn btn-danger btn-lg">
                            {{ card.form.button_text }}
                        </button>
                    </form>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
